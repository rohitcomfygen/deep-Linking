<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deep Link Test</title>
</head>

<body>
  <div id="app"></div>
  <script>
    const app = document.getElementById('app');

    const APP_SCHEME = `Eyision://news`;
    const PLAY_STORE = `https://play.google.com/store/apps/details?id=com.app.eysion`;
    const APP_STORE = `https://apps.apple.com/in/app/eyision/id6749613401`;

    function openApp() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;
      const isAndroid = /android/i.test(userAgent);
      const isIOS = /iPhone|iPad|iPod/i.test(userAgent);

      const start = Date.now();

      // Try to open the app
      if (isAndroid) {
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = APP_SCHEME;
        document.body.appendChild(iframe);
      } else {
        window.location = APP_SCHEME;
      }

      // Use a strict timeout to fallback to store if app is not installed
      setTimeout(() => {
        const elapsed = Date.now() - start;
        // If less than 1500 ms passed, app likely did NOT open
        if (elapsed < 1500) {
          window.location = isAndroid ? PLAY_STORE : APP_STORE;
        }
      }, 1200);
    }

    app.innerHTML = `
      <h1>Deep Link Test Page</h1>
      <button onclick="openApp()">Open App</button>
    `;
  </script>
</body>

</html>